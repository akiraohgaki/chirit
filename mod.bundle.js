var s={globalThis};s.globalThis.HTMLElement||(s.globalThis={...s.globalThis,HTMLElement:class{}});function T(r,t){let e=!1,n;return(...o)=>{e||(clearTimeout(n),n=setTimeout(()=>{e=!0,Promise.resolve().then(()=>r(...o)).catch(i=>{console.error(i)}).finally(()=>{e=!1})},t))}}var c=class extends s.globalThis.HTMLElement{#n;#e;static get observedAttributes(){return[]}static define(t,e){s.globalThis.customElements.define(t,this,e)}constructor(){super(),this.#n=0,this.#e=T(this.updateSync.bind(this),50)}get updateCounter(){return this.#n}attributeChangedCallback(t,e,n,o){this.#n&&e!==n&&this.update()}connectedCallback(){this.#n?this.update():this.updateSync()}disconnectedCallback(){}adoptedCallback(t,e){}update(){this.#e()}updateSync(){try{this.render(),this.#n++,this.updatedCallback()}catch(t){this.errorCallback(t)}}render(){}updatedCallback(){}errorCallback(t){console.error(t)}};var f=class{#n;#e;constructor(t){this.#n=new WeakRef(t),this.#e=this.#o()}get proxy(){return this.#e}#t(){if(this.#n){let t=this.#n.deref();if(t)return t;this.#n=null}throw new Error("The target element is not available.")}#o(){return new Proxy({},{set:(t,e,n)=>{let o=this.#t();return typeof e=="string"&&typeof n=="string"?(o.setAttribute(e,n),!0):!1},get:(t,e)=>{let n=this.#t();if(typeof e=="string"&&n.hasAttribute(e))return n.getAttribute(e)},deleteProperty:(t,e)=>{let n=this.#t();return typeof e=="string"&&n.hasAttribute(e)?(n.removeAttribute(e),!0):!1},has:(t,e)=>{let n=this.#t();return!!(typeof e=="string"&&n.hasAttribute(e))},ownKeys:()=>{let t=this.#t(),e=[];if(t.hasAttributes())for(let n of Array.from(t.attributes))e.push(n.name);return e},getOwnPropertyDescriptor:(t,e)=>{let n=this.#t();if(typeof e=="string"&&n.hasAttribute(e))return{configurable:!0,enumerable:!0,value:n.getAttribute(e)}}})}};function h(r,t){return m(r,t,new WeakSet)}function m(r,t,e){if(typeof r!=typeof t)return!1;if(r!==null&&typeof r=="object"&&t!==null&&typeof t=="object"){if(e.has(r)||e.has(t))return e.has(r)&&e.has(t);if(e.add(r),e.add(t),Array.isArray(r)&&Array.isArray(t)){if(r.length!==t.length)return!1;for(let n=0;n<r.length;n++)if(!m(r[n],t[n],e))return!1;return!0}if(r.constructor===Object&&t.constructor===Object){let n=Object.keys(r),o=Object.keys(t);if(n.length!==o.length)return!1;for(let i of n)if(!m(r[i],t[i],e))return!1;return!0}}return r===t}var d=class{#n;#e;#t;#o;#s;#r;constructor(t,e){this.#n=new WeakRef(t),this.#e=e,this.#t=new Map,this.#h(),this.#o=this.#l(),this.#s=()=>{},this.#r=n=>{console.error(n)}}get proxy(){return this.#o}set onchange(t){this.#s=t}get onchange(){return this.#s}set onerror(t){this.#r=t}get onerror(){return this.#r}sync(){let t=this.#i();for(let[e,n]of Object.entries(this.#e))t.hasAttribute(e)||typeof this.#t.get(e)=="boolean"?this.reflectFromAttribute(e):n.reflect&&this.reflectToAttribute(e)}reflectFromAttribute(t){let e=this.#e[t];if(!e)return;let n=this.#i(),o=this.#t.get(t);if(!n.hasAttribute(t)&&typeof o!="boolean")return;let i=n.getAttribute(t)??"";try{e.converter&&typeof e.converter=="function"?this.#t.set(t,e.converter(i)):typeof o=="boolean"?this.#t.set(t,n.hasAttribute(t)):typeof o=="string"?this.#t.set(t,i):typeof o=="number"?this.#t.set(t,Number(i)):typeof o=="bigint"?this.#t.set(t,BigInt(i)):typeof o=="object"&&o!==null?this.#t.set(t,JSON.parse(i)):this.#t.set(t,i)}catch(u){this.#r(u)}let a=this.#t.get(t);h(o,a)||this.#s(t,o,a)}reflectToAttribute(t){if(!this.#e[t])return;let n=this.#i(),o=this.#t.get(t);try{o==null?n.removeAttribute(t):typeof o=="boolean"?o?n.setAttribute(t,""):n.removeAttribute(t):typeof o=="string"?n.setAttribute(t,o):typeof o=="number"||typeof o=="bigint"?n.setAttribute(t,String(o)):typeof o=="object"&&o!==null?n.setAttribute(t,JSON.stringify(o)):n.setAttribute(t,String(o))}catch(i){this.#r(i)}}#i(){if(this.#n){let t=this.#n.deref();if(t)return t;this.#n=null}throw new Error("The target element is not available.")}#h(){for(let[t,e]of Object.entries(this.#e))this.#t.set(t,e.value)}#l(){return new Proxy({},{set:(t,e,n)=>{if(typeof e=="string"&&this.#t.has(e)){let o=this.#t.get(e);return this.#t.set(e,n),h(o,n)||(this.#s(e,o,n),this.#e[e].reflect&&this.reflectToAttribute(e)),!0}return!1},get:(t,e)=>{if(typeof e=="string"&&this.#t.has(e))return this.#t.get(e)},deleteProperty:(t,e)=>!1,has:(t,e)=>!!(typeof e=="string"&&this.#t.has(e)),ownKeys:()=>Array.from(this.#t.keys()),getOwnPropertyDescriptor:(t,e)=>{if(typeof e=="string"&&this.#t.has(e))return{configurable:!0,enumerable:!0,value:this.#t.get(e)}}})}};var b=new WeakSet,p=class{#n;#e;#t;constructor(t,e){b.add(t),this.#n=new WeakRef(t),this.#e=e?new WeakRef(e):null,this.#t=new Set}get host(){return this.#o()}adoptStyles(t){let e=this.#o();if(e instanceof s.globalThis.Document||e instanceof s.globalThis.ShadowRoot){let n=[],o=Array.isArray(t)?t:[t];for(let i of o)if(i instanceof s.globalThis.CSSStyleSheet)n.push(i);else if(typeof i=="string"){let a=new s.globalThis.CSSStyleSheet;a.replaceSync(i),n.push(a)}n.length&&(e.adoptedStyleSheets=n)}else console.warn('The style sheets cannot be adopted because the host node is not a "Document" or "ShadowRoot".')}update(t){let e=this.#o();this.#a(),t instanceof s.globalThis.Document||t instanceof s.globalThis.DocumentFragment?this.#i(e,t):this.#i(e,this.#r(t)),this.#u(e)}clone(){let t=this.#o();return this.#r(t.childNodes)}#o(){if(this.#n){let t=this.#n.deref();if(t)return t;this.#n=null}throw new Error("The host node is not available.")}#s(){if(this.#e){let t=this.#e.deref();if(t)return t;this.#e=null}}#r(t){if(typeof t=="string"){let n=s.globalThis.document.createElement("template");return n.innerHTML=t,n.content}let e=s.globalThis.document.createDocumentFragment();if(t instanceof s.globalThis.Node)e.appendChild(t.cloneNode(!0));else if(t instanceof s.globalThis.NodeList&&t.length)for(let n of Array.from(t))e.appendChild(n.cloneNode(!0));return e}#i(t,e){if(t.hasChildNodes()||e.hasChildNodes()){let n=Array.from(t.childNodes),o=Array.from(e.childNodes),i=Math.max(n.length,o.length);for(let a=0;a<i;a++)this.#h(t,n[a]??null,o[a]??null)}}#h(t,e,n){e&&!n?t.removeChild(e):!e&&n?t.appendChild(n.cloneNode(!0)):e&&n&&(e.nodeType===n.nodeType&&e.nodeName===n.nodeName?e instanceof s.globalThis.Element&&n instanceof s.globalThis.Element?(this.#l(e,n),b.has(e)||this.#i(e,n)):e instanceof s.globalThis.CharacterData&&n instanceof s.globalThis.CharacterData?e.nodeValue!==n.nodeValue&&(e.nodeValue=n.nodeValue):t.replaceChild(n.cloneNode(!0),e):t.replaceChild(n.cloneNode(!0),e))}#l(t,e){if(t.hasAttributes())for(let n of Array.from(t.attributes))e.hasAttribute(n.name)||t.removeAttribute(n.name);if(e.hasAttributes())for(let n of Array.from(e.attributes))(!t.hasAttribute(n.name)||t.getAttribute(n.name)!==n.value)&&t.setAttribute(n.name,n.value)}#u(t){if(t.hasChildNodes())for(let e of Array.from(t.childNodes))e instanceof s.globalThis.Element&&this.#c(e)}#c(t){if(t.hasAttributes()){for(let e of Array.from(t.attributes))if(e.name.search(/^on\w+/i)!==-1){let n=e.name.toLowerCase(),o=t;if(n in t&&typeof o[n]=="function"){let i=new Function("event",e.value),a=this.#s();t.removeAttribute(e.name),o[n]=i.bind(a??t),this.#t.add([t,n])}}}b.has(t)||this.#u(t)}#a(){for(let[t,e]of this.#t){let n=t;n[e]=null}this.#t.clear()}};var g=class extends c{#n;#e;#t;static get observedAttributes(){return Object.keys(this.properties)}static get properties(){return{}}constructor(){super(),this.update=this.update.bind(this),this.#n=new f(this),this.#e=new d(this,this.constructor.properties),this.#t=new p(this.createContentContainer(),this)}get elementAttributes(){return this.#n}get elementProperties(){return this.#e}get nodeStructure(){return this.#t}get attrs(){return this.#n.proxy}get props(){return this.#e.proxy}get content(){return this.#t.host}attributeChangedCallback(t,e,n,o){this.updateCounter&&e!==n&&(this.#e.reflectFromAttribute(t),this.update())}connectedCallback(){this.updateCounter?this.update():(this.#e.sync(),this.#e.onchange=()=>{this.update()},this.updateSync())}observe(...t){for(let e of t)e.subscribe&&typeof e.subscribe=="function"&&e.subscribe(this.update)}unobserve(...t){for(let e of t)e.unsubscribe&&typeof e.unsubscribe=="function"&&e.unsubscribe(this.update)}dispatch(t,e){return this.#t.host.dispatchEvent(new s.globalThis.CustomEvent(t,{detail:e,bubbles:!0,composed:!0}))}createContentContainer(){return this.attachShadow({mode:"open"})}render(){!this.updateCounter&&this.#t.host instanceof s.globalThis.ShadowRoot&&this.#t.adoptStyles(this.styles()),this.#t.update(this.template())}styles(){return[]}template(){return""}};var l=class{#n;constructor(){this.#n=new Set}subscribe(t){this.#n.add(t)}unsubscribe(t){this.#n.delete(t)}notify(t){for(let e of this.#n)e(t)}};var y=class{#n;#e;#t;#o;#s;#r;#i;constructor(t,e=""){if(t!=="hash"&&t!=="history")throw new Error('The routing mode must be set to "hash" or "history".');this.#n=t,this.#e=e&&!e.endsWith("/")?e+"/":e,this.#t=()=>{},this.#o=n=>{console.error(n)},this.#s=new Map,this.#r=this.#u.bind(this),this.#i=this.#c.bind(this)}get mode(){return this.#n}get base(){return this.#e}get size(){return this.#s.size}set onchange(t){this.#t=t}get onchange(){return this.#t}set onerror(t){this.#o=t}get onerror(){return this.#o}set(t,e){this.#s.size||(this.#n==="hash"?s.globalThis.addEventListener("hashchange",this.#r):this.#n==="history"&&s.globalThis.addEventListener("popstate",this.#i)),this.#s.set(this.#d(t),e)}delete(t){this.#s.delete(this.#d(t)),this.#s.size||(this.#n==="hash"?s.globalThis.removeEventListener("hashchange",this.#r):this.#n==="history"&&s.globalThis.removeEventListener("popstate",this.#i))}navigate(t){this.#n==="hash"?this.#h(t):this.#n==="history"&&this.#l(t)}#h(t){let e="";if(t.search(/^[A-Za-z0-9\+\-\.]+:\/\/|\?|#/)!==-1){let a=new URL(t,s.globalThis.location.href),u=a.href.split("#"),S=s.globalThis.location.href.split("#");if(u[0]!==S[0]){s.globalThis.location.href=a.href;return}e=u[1]??""}else e=t;let n=s.globalThis.location.hash.substring(1),o=new URL(n,s.globalThis.location.origin),i=new URL(this.#f(e),o.href);if(i.pathname!==n){s.globalThis.location.hash=i.pathname;return}this.#a(i.pathname)}#l(t){let e=new URL(this.#f(t),s.globalThis.location.href);if(e.origin!==s.globalThis.location.origin){s.globalThis.location.href=e.href;return}e.href!==s.globalThis.location.href&&(s.globalThis.history.pushState({},"",e.href),this.#t(new s.globalThis.CustomEvent("pushstate"))),this.#a(e.pathname)}#u(t){this.#t(t),this.#a(s.globalThis.location.hash.substring(1))}#c(t){this.#t(t),this.#a(s.globalThis.location.pathname)}#a(t){try{for(let[e,n]of this.#s){let o=t.match(new RegExp(e));if(o){n(o.groups??{});break}}}catch(e){this.#o(e)}}#f(t){return this.#e&&t.search(/^([A-Za-z0-9\+\-\.]+:\/\/|\/)/)===-1?this.#e+t:t}#d(t){return`/${t}`.replace(/([^?]):(\w+)/g,"$1(?<$2>[^/?#]+)").substring(1)}};var w=class extends l{#n;#e;constructor(t){super(),this.#n=s.globalThis.structuredClone(t),this.#e=s.globalThis.structuredClone(t)}reset(){let t=h(this.#e,this.#n);this.#e=s.globalThis.structuredClone(this.#n),t||this.notify()}set(t){let e=h(this.#e,t);this.#e=s.globalThis.structuredClone(t),e||this.notify()}get(){return this.#e}notify(){super.notify(this.#e)}};var C=class extends l{#n;#e;constructor(t){super(),this.#n=s.globalThis.structuredClone(t),this.#e=s.globalThis.structuredClone(t)}get state(){return this.#e}reset(){let t=h(this.#e,this.#n);this.#e=s.globalThis.structuredClone(this.#n),t||this.notify()}update(t){let e={...this.#e,...t},n=h(this.#e,e);this.#e=s.globalThis.structuredClone(e),n||this.notify()}notify(){super.notify(this.#e)}};var v=class{#n;#e;#t;constructor(t,e=""){switch(this.#n=t,this.#e=e,this.#n){case"local":{this.#t=s.globalThis.localStorage;break}case"session":{this.#t=s.globalThis.sessionStorage;break}default:throw new Error('The storage mode must be set to "local" or "session".')}}get mode(){return this.#n}get prefix(){return this.#e}get size(){return this.#t.length}keys(){let t=[];if(this.#t.length)for(let e=0;e<this.#t.length;e++)t.push(this.#t.key(e));return t}set(t,e){this.#t.setItem(this.#e+t,JSON.stringify({_v:e}))}get(t){let e=this.#t.getItem(this.#e+t);if(typeof e=="string"){if(e)try{let n=JSON.parse(e);return typeof n=="object"&&n!==null?n._v:e}catch{return e}return e}}delete(t){this.#t.removeItem(this.#e+t)}clear(){this.#t.clear()}};function nt(r,t={}){let e=t.base??g,n=class extends e{static get properties(){return t.properties&&typeof t.properties=="object"?t.properties:super.properties}constructor(){super(),t.init&&typeof t.init=="function"&&t.init(this)}connectedCallback(){super.connectedCallback(),t.connected&&typeof t.connected=="function"&&t.connected(this)}disconnectedCallback(){t.disconnected&&typeof t.disconnected=="function"&&t.disconnected(this),super.disconnectedCallback()}styles(){return t.styles&&typeof t.styles=="function"?t.styles(this):super.styles()}template(){return t.template&&typeof t.template=="function"?t.template(this):super.template()}};return n.define(r),n}function it(r,...t){let e=r.reduce((o,i,a)=>o+i+(a<t.length?t[a]:""),""),n=new s.globalThis.CSSStyleSheet;return n.replaceSync(e),n}function lt(r,...t){let e=r.reduce((o,i,a)=>o+i+(a<t.length?t[a]:""),""),n=s.globalThis.document.createElement("template");return n.innerHTML=e,n.content}export{g as Component,c as CustomElement,f as ElementAttributes,d as ElementProperties,p as NodeStructure,l as Observable,y as Router,w as State,C as Store,v as WebStorage,nt as createComponent,it as css,s as dom,lt as html};
