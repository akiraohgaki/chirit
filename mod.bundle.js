var r={globalThis};r.globalThis.HTMLElement||(r.globalThis={...r.globalThis,HTMLElement:class{}});function y(o,t){let e=!1,n;return(...s)=>{e||(clearTimeout(n),n=setTimeout(()=>{e=!0,Promise.resolve().then(()=>o(...s)).catch(i=>{console.error(i)}).finally(()=>{e=!1})},t))}}var c=class extends r.globalThis.HTMLElement{#n;#e;static get observedAttributes(){return[]}static define(t,e){r.globalThis.customElements.define(t,this,e)}constructor(){super(),this.#n=0,this.#e=y(this.updateSync.bind(this),50)}get updateCounter(){return this.#n}attributeChangedCallback(t,e,n,s){this.#n&&e!==n&&this.update()}connectedCallback(){this.#n?this.update():this.updateSync()}disconnectedCallback(){}adoptedCallback(t,e){}update(){this.#e()}updateSync(){try{this.render(),this.#n++,this.updatedCallback()}catch(t){this.errorCallback(t)}}render(){}updatedCallback(){}errorCallback(t){console.error(t)}};var f=class{#n;#e;constructor(t){this.#n=new WeakRef(t),this.#e=this.#s()}get proxy(){return this.#e}#t(){if(this.#n){let t=this.#n.deref();if(t)return t;this.#n=null}throw new Error("The target element is not available.")}#s(){return new Proxy({},{set:(t,e,n)=>{let s=this.#t();return typeof e=="string"&&typeof n=="string"?(s.setAttribute(e,n),!0):!1},get:(t,e)=>{let n=this.#t();if(typeof e=="string"&&n.hasAttribute(e))return n.getAttribute(e)},deleteProperty:(t,e)=>{let n=this.#t();return typeof e=="string"&&n.hasAttribute(e)?(n.removeAttribute(e),!0):!1},has:(t,e)=>{let n=this.#t();return!!(typeof e=="string"&&n.hasAttribute(e))},ownKeys:()=>{let t=this.#t(),e=[];if(t.hasAttributes())for(let n of Array.from(t.attributes))e.push(n.name);return e},getOwnPropertyDescriptor:(t,e)=>{let n=this.#t();if(typeof e=="string"&&n.hasAttribute(e))return{configurable:!0,enumerable:!0,value:n.getAttribute(e)}}})}};function h(o,t){return m(o,t,new WeakSet)}function m(o,t,e){if(typeof o!=typeof t)return!1;if(o!==null&&typeof o=="object"&&t!==null&&typeof t=="object"){if(e.has(o)||e.has(t))return e.has(o)&&e.has(t);if(e.add(o),e.add(t),Array.isArray(o)&&Array.isArray(t)){if(o.length!==t.length)return!1;for(let n=0;n<o.length;n++)if(!m(o[n],t[n],e))return!1;return!0}if(o.constructor===Object&&t.constructor===Object){let n=Object.keys(o),s=Object.keys(t);if(n.length!==s.length)return!1;for(let i of n)if(!m(o[i],t[i],e))return!1;return!0}}return o===t}var d=class{#n;#e;#t;#s;#r;constructor(t,e){this.#n=new WeakRef(t),this.#e=e,this.#t=new Map,this.#i(),this.#s=this.#h(),this.#r=()=>{}}get proxy(){return this.#s}set onchange(t){this.#r=t}get onchange(){return this.#r}sync(){let t=this.#o();for(let[e,n]of Object.entries(this.#e))t.hasAttribute(e)||typeof this.#t.get(e)=="boolean"?this.reflectFromAttribute(e):n.reflect&&this.reflectToAttribute(e)}reflectFromAttribute(t){let e=this.#e[t];if(!e)return;let n=this.#o(),s=this.#t.get(t);if(!n.hasAttribute(t)&&typeof s!="boolean")return;let i=n.getAttribute(t)??"";try{e.converter&&typeof e.converter=="function"?this.#t.set(t,e.converter(i)):typeof s=="boolean"?this.#t.set(t,n.hasAttribute(t)):typeof s=="string"?this.#t.set(t,i):typeof s=="number"?this.#t.set(t,Number(i)):typeof s=="bigint"?this.#t.set(t,BigInt(i)):typeof s=="object"&&s!==null?this.#t.set(t,JSON.parse(i)):this.#t.set(t,i)}catch(u){console.error(`An error occurred while reflecting from attribute "${t}".`,u)}let a=this.#t.get(t);h(s,a)||this.#r(t,s,a)}reflectToAttribute(t){if(!this.#e[t])return;let n=this.#o(),s=this.#t.get(t);try{s==null?n.removeAttribute(t):typeof s=="boolean"?s?n.setAttribute(t,""):n.removeAttribute(t):typeof s=="string"?n.setAttribute(t,s):typeof s=="number"||typeof s=="bigint"?n.setAttribute(t,String(s)):typeof s=="object"&&s!==null?n.setAttribute(t,JSON.stringify(s)):n.setAttribute(t,String(s))}catch(i){console.error(`An error occurred while reflecting to attribute "${t}".`,i)}}#o(){if(this.#n){let t=this.#n.deref();if(t)return t;this.#n=null}throw new Error("The target element is not available.")}#i(){for(let[t,e]of Object.entries(this.#e))this.#t.set(t,e.value)}#h(){return new Proxy({},{set:(t,e,n)=>{if(typeof e=="string"&&this.#t.has(e)){let s=this.#t.get(e);return this.#t.set(e,n),h(s,n)||(this.#r(e,s,n),this.#e[e].reflect&&this.reflectToAttribute(e)),!0}return!1},get:(t,e)=>{if(typeof e=="string"&&this.#t.has(e))return this.#t.get(e)},deleteProperty:(t,e)=>!1,has:(t,e)=>!!(typeof e=="string"&&this.#t.has(e)),ownKeys:()=>Array.from(this.#t.keys()),getOwnPropertyDescriptor:(t,e)=>{if(typeof e=="string"&&this.#t.has(e))return{configurable:!0,enumerable:!0,value:this.#t.get(e)}}})}};var b=new WeakSet,g=class{#n;#e;#t;constructor(t,e){b.add(t),this.#n=new WeakRef(t),this.#e=e?new WeakRef(e):null,this.#t=new Set}get host(){return this.#s()}adoptStyles(t){let e=this.#s();if(e instanceof r.globalThis.Document||e instanceof r.globalThis.ShadowRoot){let n=[],s=Array.isArray(t)?t:[t];for(let i of s)if(i instanceof r.globalThis.CSSStyleSheet)n.push(i);else if(typeof i=="string"){let a=new r.globalThis.CSSStyleSheet;a.replaceSync(i),n.push(a)}n.length&&(e.adoptedStyleSheets=n)}else console.warn('The style sheets cannot be adopted because the host node is not a "Document" or "ShadowRoot".')}update(t){let e=this.#s();this.#a(),t instanceof r.globalThis.Document||t instanceof r.globalThis.DocumentFragment?this.#i(e,t):this.#i(e,this.#o(t)),this.#l(e)}clone(){let t=this.#s();return this.#o(t.childNodes)}#s(){if(this.#n){let t=this.#n.deref();if(t)return t;this.#n=null}throw new Error("The host node is not available.")}#r(){if(this.#e){let t=this.#e.deref();if(t)return t;this.#e=null}}#o(t){if(typeof t=="string"){let n=r.globalThis.document.createElement("template");return n.innerHTML=t,n.content}let e=r.globalThis.document.createDocumentFragment();if(t instanceof r.globalThis.Node)e.appendChild(t.cloneNode(!0));else if(t instanceof r.globalThis.NodeList&&t.length)for(let n of Array.from(t))e.appendChild(n.cloneNode(!0));return e}#i(t,e){if(t.hasChildNodes()||e.hasChildNodes()){let n=Array.from(t.childNodes),s=Array.from(e.childNodes),i=Math.max(n.length,s.length);for(let a=0;a<i;a++)this.#h(t,n[a]??null,s[a]??null)}}#h(t,e,n){e&&!n?t.removeChild(e):!e&&n?t.appendChild(n.cloneNode(!0)):e&&n&&(e.nodeType===n.nodeType&&e.nodeName===n.nodeName?e instanceof r.globalThis.Element&&n instanceof r.globalThis.Element?(this.#u(e,n),b.has(e)||this.#i(e,n)):e instanceof r.globalThis.CharacterData&&n instanceof r.globalThis.CharacterData?e.nodeValue!==n.nodeValue&&(e.nodeValue=n.nodeValue):t.replaceChild(n.cloneNode(!0),e):t.replaceChild(n.cloneNode(!0),e))}#u(t,e){if(t.hasAttributes())for(let n of Array.from(t.attributes))e.hasAttribute(n.name)||t.removeAttribute(n.name);if(e.hasAttributes())for(let n of Array.from(e.attributes))(!t.hasAttribute(n.name)||t.getAttribute(n.name)!==n.value)&&t.setAttribute(n.name,n.value)}#l(t){if(t.hasChildNodes())for(let e of Array.from(t.childNodes))e instanceof r.globalThis.Element&&this.#c(e)}#c(t){if(t.hasAttributes()){for(let e of Array.from(t.attributes))if(e.name.search(/^on\w+/i)!==-1){let n=e.name.toLowerCase(),s=t;if(n in t&&typeof s[n]=="function"){let i=new Function("event",e.value),a=this.#r();t.removeAttribute(e.name),s[n]=i.bind(a??t),this.#t.add([t,n])}}}b.has(t)||this.#l(t)}#a(){for(let[t,e]of this.#t){let n=t;n[e]=null}this.#t.clear()}};var p=class extends c{#n;#e;#t;static get observedAttributes(){return Object.keys(this.properties)}static get properties(){return{}}constructor(){super(),this.update=this.update.bind(this),this.#n=new f(this),this.#e=new d(this,this.constructor.properties),this.#t=new g(this.createContentContainer(),this)}get elementAttributes(){return this.#n}get elementProperties(){return this.#e}get nodeStructure(){return this.#t}get attrs(){return this.#n.proxy}get props(){return this.#e.proxy}get content(){return this.#t.host}attributeChangedCallback(t,e,n,s){this.updateCounter&&e!==n&&(this.#e.reflectFromAttribute(t),this.update())}connectedCallback(){this.updateCounter?this.update():(this.#e.sync(),this.#e.onchange=()=>{this.update()},this.updateSync())}observe(...t){for(let e of t)e.subscribe&&typeof e.subscribe=="function"&&e.subscribe(this.update)}unobserve(...t){for(let e of t)e.unsubscribe&&typeof e.unsubscribe=="function"&&e.unsubscribe(this.update)}dispatch(t,e){return this.#t.host.dispatchEvent(new r.globalThis.CustomEvent(t,{detail:e,bubbles:!0,composed:!0}))}createContentContainer(){return this.attachShadow({mode:"open"})}render(){!this.updateCounter&&this.#t.host instanceof r.globalThis.ShadowRoot&&this.#t.adoptStyles(this.styles()),this.#t.update(this.template())}styles(){return[]}template(){return""}};var l=class{#n;constructor(){this.#n=new Set}subscribe(t){this.#n.add(t)}unsubscribe(t){this.#n.delete(t)}notify(t){for(let e of this.#n)e(t)}};var T=class{#n;#e;#t;#s;#r;#o;#i;constructor(t,e=""){if(t!=="hash"&&t!=="history")throw new Error('The routing mode must be set to "hash" or "history".');this.#n=t,this.#e=e&&!e.endsWith("/")?e+"/":e,this.#t=()=>{},this.#s=n=>{console.error(n)},this.#r=new Map,this.#o=this.#l.bind(this),this.#i=this.#c.bind(this)}get mode(){return this.#n}get base(){return this.#e}get size(){return this.#r.size}set onchange(t){this.#t=t}get onchange(){return this.#t}set onerror(t){this.#s=t}get onerror(){return this.#s}set(t,e){this.#r.size||(this.#n==="hash"?r.globalThis.addEventListener("hashchange",this.#o):this.#n==="history"&&r.globalThis.addEventListener("popstate",this.#i)),this.#r.set(this.#d(t),e)}delete(t){this.#r.delete(this.#d(t)),this.#r.size||(this.#n==="hash"?r.globalThis.removeEventListener("hashchange",this.#o):this.#n==="history"&&r.globalThis.removeEventListener("popstate",this.#i))}navigate(t){this.#n==="hash"?this.#h(t):this.#n==="history"&&this.#u(t)}#h(t){let e="";if(t.search(/^[A-Za-z0-9\+\-\.]+:\/\/|\?|#/)!==-1){let a=new URL(t,r.globalThis.location.href),u=a.href.split("#"),S=r.globalThis.location.href.split("#");if(u[0]!==S[0]){r.globalThis.location.href=a.href;return}e=u[1]??""}else e=t;let n=r.globalThis.location.hash.substring(1),s=new URL(n,r.globalThis.location.origin),i=new URL(this.#f(e),s.href);if(i.pathname!==n){r.globalThis.location.hash=i.pathname;return}this.#a(i.pathname)}#u(t){let e=new URL(this.#f(t),r.globalThis.location.href);if(e.origin!==r.globalThis.location.origin){r.globalThis.location.href=e.href;return}e.href!==r.globalThis.location.href&&(r.globalThis.history.pushState({},"",e.href),this.#t(new r.globalThis.CustomEvent("pushstate"))),this.#a(e.pathname)}#l(t){this.#t(t),this.#a(r.globalThis.location.hash.substring(1))}#c(t){this.#t(t),this.#a(r.globalThis.location.pathname)}#a(t){try{for(let[e,n]of this.#r){let s=t.match(new RegExp(e));if(s){n(s.groups??{});break}}}catch(e){this.#s(e)}}#f(t){return this.#e&&t.search(/^([A-Za-z0-9\+\-\.]+:\/\/|\/)/)===-1?this.#e+t:t}#d(t){return`/${t}`.replace(/([^?]):(\w+)/g,"$1(?<$2>[^/?#]+)").substring(1)}};var w=class extends l{#n;#e;constructor(t){super(),this.#n=r.globalThis.structuredClone(t),this.#e=r.globalThis.structuredClone(t)}reset(){let t=h(this.#e,this.#n);this.#e=r.globalThis.structuredClone(this.#n),t||this.notify()}set(t){let e=h(this.#e,t);this.#e=r.globalThis.structuredClone(t),e||this.notify()}get(){return this.#e}notify(){super.notify(this.#e)}};var v=class extends l{#n;#e;constructor(t){super(),this.#n=r.globalThis.structuredClone(t),this.#e=r.globalThis.structuredClone(t)}get state(){return this.#e}reset(){let t=h(this.#e,this.#n);this.#e=r.globalThis.structuredClone(this.#n),t||this.notify()}update(t){let e={...this.#e,...t},n=h(this.#e,e);this.#e=r.globalThis.structuredClone(e),n||this.notify()}notify(){super.notify(this.#e)}};var C=class{#n;#e;#t;constructor(t,e=""){switch(this.#n=t,this.#e=e,this.#n){case"local":{this.#t=r.globalThis.localStorage;break}case"session":{this.#t=r.globalThis.sessionStorage;break}default:throw new Error('The storage mode must be set to "local" or "session".')}}get mode(){return this.#n}get prefix(){return this.#e}get size(){return this.#t.length}keys(){let t=[];if(this.#t.length)for(let e=0;e<this.#t.length;e++)t.push(this.#t.key(e));return t}set(t,e){this.#t.setItem(this.#e+t,JSON.stringify({_v:e}))}get(t){let e=this.#t.getItem(this.#e+t);if(typeof e=="string"){if(e)try{let n=JSON.parse(e);return typeof n=="object"&&n!==null?n._v:e}catch{return e}return e}}delete(t){this.#t.removeItem(this.#e+t)}clear(){this.#t.clear()}};function nt(o,t={}){let e=t.base??p,n=class extends e{static get properties(){return t.properties&&typeof t.properties=="object"?t.properties:super.properties}constructor(){super(),t.init&&typeof t.init=="function"&&t.init(this)}connectedCallback(){super.connectedCallback(),t.connected&&typeof t.connected=="function"&&t.connected(this)}disconnectedCallback(){t.disconnected&&typeof t.disconnected=="function"&&t.disconnected(this),super.disconnectedCallback()}styles(){return t.styles&&typeof t.styles=="function"?t.styles(this):super.styles()}template(){return t.template&&typeof t.template=="function"?t.template(this):super.template()}};return n.define(o),n}function it(o,...t){let e=o.reduce((s,i,a)=>s+i+(a<t.length?t[a]:""),""),n=new r.globalThis.CSSStyleSheet;return n.replaceSync(e),n}function lt(o,...t){let e=o.reduce((s,i,a)=>s+i+(a<t.length?t[a]:""),""),n=r.globalThis.document.createElement("template");return n.innerHTML=e,n.content}export{p as Component,c as CustomElement,f as ElementAttributes,d as ElementProperties,g as NodeStructure,l as Observable,T as Router,w as State,v as Store,C as WebStorage,nt as createComponent,it as css,r as dom,lt as html};
