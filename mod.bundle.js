var s={globalThis};s.globalThis.HTMLElement||(s.globalThis={...s.globalThis,HTMLElement:class{}});function b(o,t){let e=!1,n;return(...a)=>{e||(clearTimeout(n),n=setTimeout(()=>{e=!0,Promise.resolve().then(()=>o(...a)).catch(r=>{console.error(r)}).finally(()=>{e=!1})},t))}}var c=class extends s.globalThis.HTMLElement{#e;#t;static get observedAttributes(){return[]}static define(t,e){s.globalThis.customElements.define(t,this,e)}constructor(){super(),this.#e=0,this.#t=b(this.updateSync.bind(this),50)}get updateCounter(){return this.#e}attributeChangedCallback(t,e,n,a){this.#e&&e!==n&&this.update()}connectedCallback(){this.#e?this.update():this.updateSync()}disconnectedCallback(){}adoptedCallback(t,e){}update(){this.#t()}updateSync(){try{this.render(),this.#e++,this.updatedCallback()}catch(t){this.errorCallback(t)}}render(){}updatedCallback(){}errorCallback(t){console.error(t)}};var d=class{constructor(t){let e=new WeakRef(t),n=()=>{if(e){let a=e.deref();if(a)return a;e=null}throw new Error("The target element is not available.")};return new Proxy({},{set:(a,r,i)=>{let u=n();return typeof r=="string"&&typeof i=="string"?(u.setAttribute(r,i),!0):!1},get:(a,r)=>{let i=n();if(typeof r=="string"&&i.hasAttribute(r))return i.getAttribute(r)},deleteProperty:(a,r)=>{let i=n();return typeof r=="string"&&i.hasAttribute(r)?(i.removeAttribute(r),!0):!1},has:(a,r)=>{let i=n();return!!(typeof r=="string"&&i.hasAttribute(r))},ownKeys:()=>{let a=n(),r=[];if(a.hasAttributes())for(let i of Array.from(a.attributes))r.push(i.name);return r},getOwnPropertyDescriptor:(a,r)=>{let i=n();if(typeof r=="string"&&i.hasAttribute(r))return{configurable:!0,enumerable:!0,value:i.getAttribute(r)}}})}};var m=new WeakSet,f=class{#e;#t;#n;constructor(t,e){m.add(t),this.#e=new WeakRef(t),this.#t=e?new WeakRef(e):null,this.#n=new Set}get host(){return this.#s()}adoptStyles(t){let e=this.#s();if(e instanceof s.globalThis.Document||e instanceof s.globalThis.ShadowRoot){let n=[],a=Array.isArray(t)?t:[t];for(let r of a)if(r instanceof s.globalThis.CSSStyleSheet)n.push(r);else if(typeof r=="string"){let i=new s.globalThis.CSSStyleSheet;i.replaceSync(r),n.push(i)}n.length&&(e.adoptedStyleSheets=n)}else console.warn('The styles cannot be adopted because the host node is not a "Document" or "ShadowRoot".')}update(t){let e=this.#s();this.#a(),t instanceof s.globalThis.Document||t instanceof s.globalThis.DocumentFragment?this.#o(e,t):this.#o(e,this.#i(t)),this.#h(e)}clone(){let t=this.#s();return this.#i(t.childNodes)}#s(){if(this.#e){let t=this.#e.deref();if(t)return t;this.#e=null}throw new Error("The host node is not available.")}#r(){if(this.#t){let t=this.#t.deref();if(t)return t;this.#t=null}}#i(t){if(typeof t=="string"){let n=s.globalThis.document.createElement("template");return n.innerHTML=t,n.content}let e=s.globalThis.document.createDocumentFragment();if(t instanceof s.globalThis.Node)e.appendChild(t.cloneNode(!0));else if(t instanceof s.globalThis.NodeList&&t.length)for(let n of Array.from(t))e.appendChild(n.cloneNode(!0));return e}#o(t,e){if(t.hasChildNodes()||e.hasChildNodes()){let n=Array.from(t.childNodes),a=Array.from(e.childNodes),r=Math.max(n.length,a.length);for(let i=0;i<r;i++)this.#l(t,n[i]??null,a[i]??null)}}#l(t,e,n){e&&!n?t.removeChild(e):!e&&n?t.appendChild(n.cloneNode(!0)):e&&n&&(e.nodeType===n.nodeType&&e.nodeName===n.nodeName?e instanceof s.globalThis.Element&&n instanceof s.globalThis.Element?(this.#u(e,n),m.has(e)||this.#o(e,n)):e instanceof s.globalThis.CharacterData&&n instanceof s.globalThis.CharacterData?e.nodeValue!==n.nodeValue&&(e.nodeValue=n.nodeValue):t.replaceChild(n.cloneNode(!0),e):t.replaceChild(n.cloneNode(!0),e))}#u(t,e){if(t.hasAttributes())for(let n of Array.from(t.attributes))e.hasAttribute(n.name)||t.removeAttribute(n.name);if(e.hasAttributes())for(let n of Array.from(e.attributes))(!t.hasAttribute(n.name)||t.getAttribute(n.name)!==n.value)&&t.setAttribute(n.name,n.value)}#h(t){if(t.hasChildNodes())for(let e of Array.from(t.childNodes))e instanceof s.globalThis.Element&&this.#c(e)}#c(t){if(t.hasAttributes()){for(let e of Array.from(t.attributes))if(e.name.search(/^on\w+/i)!==-1){let n=e.name.toLowerCase(),a=t;if(n in t&&typeof a[n]=="function"){let r=new Function("event",e.value),i=this.#r();t.removeAttribute(e.name),a[n]=r.bind(i??t),this.#n.add([t,n])}}}m.has(t)||this.#h(t)}#a(){for(let[t,e]of this.#n){let n=t;n[e]=null}this.#n.clear()}};var g=class extends c{#e;#t;constructor(){super(),this.update=this.update.bind(this),this.#e=new d(this),this.#t=new f(this.createContentContainer(),this)}get attr(){return this.#e}get structure(){return this.#t}get content(){return this.#t.host}observe(...t){for(let e of t)e.subscribe&&typeof e.subscribe=="function"&&e.subscribe(this.update)}unobserve(...t){for(let e of t)e.unsubscribe&&typeof e.unsubscribe=="function"&&e.unsubscribe(this.update)}dispatch(t,e){return this.#t.host.dispatchEvent(new s.globalThis.CustomEvent(t,{detail:e,bubbles:!0,composed:!0}))}createContentContainer(){return this.attachShadow({mode:"open"})}render(){!this.updateCounter&&this.#t.host instanceof s.globalThis.ShadowRoot&&this.#t.adoptStyles(this.styles()),this.#t.update(this.template())}styles(){return[]}template(){return""}};var h=class{#e;constructor(){this.#e=new Set}subscribe(t){this.#e.add(t)}unsubscribe(t){this.#e.delete(t)}notify(t){for(let e of this.#e)e(t)}};var y=class{#e;#t;#n;#s;#r;#i;#o;constructor(t,e=""){if(t!=="hash"&&t!=="history")throw new Error('The routing mode must be set to "hash" or "history".');this.#e=t,this.#t=e&&!e.endsWith("/")?e+"/":e,this.#n=()=>{},this.#s=n=>{console.error(n)},this.#r=new Map,this.#i=this.#h.bind(this),this.#o=this.#c.bind(this)}get mode(){return this.#e}get base(){return this.#t}set onchange(t){this.#n=t}get onchange(){return this.#n}set onerror(t){this.#s=t}get onerror(){return this.#s}set(t,e){this.#r.size||(this.#e==="hash"?s.globalThis.addEventListener("hashchange",this.#i):this.#e==="history"&&s.globalThis.addEventListener("popstate",this.#o)),this.#r.set(this.#f(t),e)}delete(t){this.#r.delete(this.#f(t)),this.#r.size||(this.#e==="hash"?s.globalThis.removeEventListener("hashchange",this.#i):this.#e==="history"&&s.globalThis.removeEventListener("popstate",this.#o))}navigate(t){this.#e==="hash"?this.#l(t):this.#e==="history"&&this.#u(t)}#l(t){let e="";if(t.search(/^[A-Za-z0-9\+\-\.]+:\/\/|\?|#/)!==-1){let i=new URL(t,s.globalThis.location.href),u=i.href.split("#"),k=s.globalThis.location.href.split("#");if(u[0]!==k[0]){s.globalThis.location.href=i.href;return}e=u[1]??""}else e=t;let n=s.globalThis.location.hash.substring(1),a=new URL(n,s.globalThis.location.origin),r=new URL(this.#d(e),a.href);if(r.pathname!==n){s.globalThis.location.hash=r.pathname;return}this.#a(r.pathname)}#u(t){let e=new URL(this.#d(t),s.globalThis.location.href);if(e.origin!==s.globalThis.location.origin){s.globalThis.location.href=e.href;return}e.href!==s.globalThis.location.href&&(s.globalThis.history.pushState({},"",e.href),this.#n(new s.globalThis.CustomEvent("pushstate"))),this.#a(e.pathname)}#h(t){this.#n(t),this.#a(s.globalThis.location.hash.substring(1))}#c(t){this.#n(t),this.#a(s.globalThis.location.pathname)}#a(t){try{for(let[e,n]of this.#r){let a=t.match(new RegExp(e));if(a){n(a.groups??{});break}}}catch(e){this.#s(e)}}#d(t){return this.#t&&t.search(/^([A-Za-z0-9\+\-\.]+:\/\/|\/)/)===-1?this.#t+t:t}#f(t){return`/${t}`.replace(/([^?]):(\w+)/g,"$1(?<$2>[^/?#]+)").substring(1)}};function l(o,t){return p(o,t,new WeakSet)}function p(o,t,e){if(typeof o!=typeof t)return!1;if(o!==null&&typeof o=="object"&&t!==null&&typeof t=="object"){if(e.has(o)||e.has(t))return e.has(o)&&e.has(t);if(e.add(o),e.add(t),Array.isArray(o)&&Array.isArray(t)){if(o.length!==t.length)return!1;for(let n=0;n<o.length;n++)if(!p(o[n],t[n],e))return!1;return!0}if(o.constructor===Object&&t.constructor===Object){let n=Object.keys(o),a=Object.keys(t);if(n.length!==a.length)return!1;for(let r of n)if(!p(o[r],t[r],e))return!1;return!0}}return o===t}var T=class extends h{#e;#t;constructor(t){super(),this.#e=s.globalThis.structuredClone(t),this.#t=s.globalThis.structuredClone(t)}reset(){let t=l(this.#t,this.#e);this.#t=s.globalThis.structuredClone(this.#e),t||this.notify()}set(t){let e=l(this.#t,t);this.#t=s.globalThis.structuredClone(t),e||this.notify()}get(){return this.#t}notify(){super.notify(this.#t)}};var v=class extends h{#e;#t;constructor(t){super(),this.#e=s.globalThis.structuredClone(t),this.#t=s.globalThis.structuredClone(t)}get state(){return this.#t}reset(){let t=l(this.#t,this.#e);this.#t=s.globalThis.structuredClone(this.#e),t||this.notify()}update(t){let e={...this.#t,...t},n=l(this.#t,e);this.#t=s.globalThis.structuredClone(e),n||this.notify()}notify(){super.notify(this.#t)}};var w=class{#e;#t;#n;constructor(t,e=""){switch(this.#e=t,this.#t=e,this.#e){case"local":{this.#n=s.globalThis.localStorage;break}case"session":{this.#n=s.globalThis.sessionStorage;break}default:throw new Error('The storage mode must be set to "local" or "session".')}}get mode(){return this.#e}get prefix(){return this.#t}get size(){return this.#n.length}keys(){let t=[];if(this.#n.length)for(let e=0;e<this.#n.length;e++)t.push(this.#n.key(e));return t}set(t,e){this.#n.setItem(this.#t+t,JSON.stringify({_v:e}))}get(t){let e=this.#n.getItem(this.#t+t);if(typeof e=="string"){if(e)try{let n=JSON.parse(e);return typeof n=="object"&&n!==null?n._v:e}catch{return e}return e}}delete(t){this.#n.removeItem(this.#t+t)}clear(){this.#n.clear()}};function Y(o,t){let e=t?.base??g,n=class extends e{static get observedAttributes(){return t?.observedAttributes&&Array.isArray(t.observedAttributes)?t.observedAttributes:super.observedAttributes}constructor(){super(),t?.init&&typeof t.init=="function"&&t.init(this)}connectedCallback(){super.connectedCallback(),t?.connected&&typeof t.connected=="function"&&t.connected(this)}disconnectedCallback(){t?.disconnected&&typeof t.disconnected=="function"&&t.disconnected(this),super.disconnectedCallback()}styles(){return t?.styles&&typeof t.styles=="function"?t.styles(this):super.styles()}template(){return t?.template&&typeof t.template=="function"?t.template(this):super.template()}};return n.define(o),n}function nt(o,...t){let e=o.reduce((a,r,i)=>a+r+(i<t.length?t[i]:""),""),n=new s.globalThis.CSSStyleSheet;return n.replaceSync(e),n}function ot(o,...t){let e=o.reduce((a,r,i)=>a+r+(i<t.length?t[i]:""),""),n=s.globalThis.document.createElement("template");return n.innerHTML=e,n.content}export{g as Component,c as CustomElement,d as ElementAttributesProxy,f as NodeStructure,h as Observable,y as Router,T as State,v as Store,w as WebStorage,Y as createComponent,nt as css,s as dom,ot as html};
